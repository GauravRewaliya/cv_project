FROM ubuntu:20.04

# update etc
RUN apt-get update

EXPOSE 3000
CMD ["bash", "-c", "rails s"]

# install
RUN apt-get install -y git nano curl gnupg2 dirmngr
RUN \curl -sSL https://get.rvm.io | bash

RUN echo '[[ -s "/usr/local/rvm/bin/rvm" ]] && . "/usr/local/rvm/bin/rvm"' >> /root/.bashrc
RUN bash -l -c 'rvm install 3.2.0 && rvm use 3.2.0 --default'
WORKDIR /cv_creater
COPY Gemfile Gemfile.lock ./
# Install Gems
RUN bundle install
# COPY Gemfile .
# RUN bash -c "gem install bundle && bundle install"
# RUN gem install rails
# copy
COPY . . 
RUN bash -c "gem install bundle && bundle install"
# pdf
RUN  apt install -f -y
RUN  apt install wget
RUN  wget https://github.com/wkhtmltopdf/wkhtmltopdf/releases/download/0.12.5/wkhtmltox_0.12.5-1.bionic_amd64.deb
RUN apt-get install /cv_creater/wkhtmltox_0.12.5-1.bionic_amd64.deb -y && rm /cv_creater/wkhtmltox_0.12.5-1.bionic_amd64.deb
# # doc
ENV DEBIAN_FRONTEND=noninteractive
RUN  apt-get install libreoffice-writer -y
