<style>
        .deleteg , .g_sm_btn {
          margin-left: 5px;
          margin-top: 5px;
          font-size: 13px;
          padding-right: 10px;
          padding-left: 10px;
        }

        .btn-add-g
        {
          font-size: 13px;margin-top: 4px;
          padding: 13px 6px 16px 6px;
        }
</style>

<%= form_with(model: curriculum_vitae )do |form| %>

  <% if curriculum_vitae.errors.any? %>
    <div class="alert alert-warning" role="alert">
      <h2>
        <%= pluralize(curriculum_vitae.errors.count, "error" ) %> errors found , cant be save
      </h2>

      <ul>
        <% curriculum_vitae.errors.each do |error| %>
          <li>
            <%= error.full_message %>
          </li>
          <% end %>
      </ul>
    </div>
  <% end %>

    <div class="row">
      <div class="col-md-6">
        <div>
          <%= form.label "Candidate"  %>
            <%= form.collection_select(:candidate_id, Candidate.all, :id,->(candidate){"#{candidate.name} , #{candidate.profile.email}"}, { include_blank: true } ,{required: true ,class: "form-control"})%>
        </div>
  
      </div>
      <div class="col-md-6">
        <div>
          <%= form.label "Designation"  %>
            <%= form.text_field :objective ,style: "width: 100%;text-align: center;" ,class: "form-control" %>
        </div>
      </div>
    </div>
      

    <div>
      <%= form.label "Profile Description"  %>
        <%= form.text_area :profile_desc ,class: "ckeditor_g" %>
    </div>

    <div class="row">
      <div class="col-md-6">
        <%= form.label "Core Skill"  %>
          <%= form.fields_for :linkable_core_tech_attributes, curriculum_vitae.linkable_core_tech do  |cs| %>
            <%= cs.collection_select :tech_stack_id, TechStack.core_skills.order(:title), :id, :title, { include_blank: true } ,{ id: "core_tech_select_id" ,class: "form-control"}%>
          <% end %>

          <% curriculum_vitae.errors[:linkable_core_tech].each do |message| %>
            <span style="background: cornsilk; color: red; border-radius: 5px;">
              <%= message %>
            </span>
          <%end%>
      </div>
      <div class="col-md-6">
        <%= form.label :supportive_skills %>
        <%= form.collection_select(:supportive_skill_ids, TechStack.supportive_skills, :id, :title , {}, {multiple: true ,class: "selectpick show-menu-arrow form-control"}) %>
      </div>
    </div>

      <div class="repeater_experience" style="margin-top: 10px;margin-bottom: 8px;" >
        <h3>Experience</h3>
        <div data-repeater-list="curriculum_vitae[company_experiences_attributes]" >
            <%= form.fields_for :company_experiences do |company_experience_form| %>
              <div class="row" data-repeater-item  style="margin-left: 0px;margin-top: 10px; margin-bottom: 2px;">
                <div class="col-6" style="padding-right: 0px;padding-left: 0px;">
                  <%=form.label "Company Name"  %>
                  <%= company_experience_form.text_field :company_name  ,class: "form-control" %>
                  <%=form.label "Role" ,style:"margin-top: 0px;" %>
                  <%= company_experience_form.text_field :role  ,class: "form-control" %>
                </div>
                <div class="col-5" style="padding-right: 0px;">
                    <div class="row">
                        <div class="col-6" style="padding-right: 2px;">
                          <%=form.label :start_date %>
                          <%= company_experience_form.date_field :start_date , max: Date.today ,class: 'form-control start_date container' ,required: "true" ,onchange:"updateEndDate(this)"%>
                        </div>
                        <div class="col-6" style="padding-left: 2px;">
                          <%=form.label :end_date %>
                          <%= company_experience_form.date_field :end_date , max: Date.today ,class: 'form-control end_date container' , onchange: "checkboxTogle(this)"%>
                        </div>
                    </div>

                    <div style="padding-left: 4%;" class="form-inline">
                      <input type="checkbox" class="inprogress_checkbox" onchange="endDateDisable(this)">
                      <p style="margin-bottom: 0px;color: #657079;">currently running</p>
                    </div>
                </div>
                <div class="col-1" style="padding-left: 0px;padding-right: 0px;padding-top: 28px;">
                  <!-- <button type="button" data-repeater-delete="" class="deleteg btn btn-outline-danger btn-sm fa fa-close " style="font-size: 13px;"></button> -->
                  <button type="button"  class="deleteg btn btn-outline-danger btn-sm fa fa-close " style="font-size: 13px;" , onclick="deleteRepeaterItem(this);"></button>
                </div>
                <%= company_experience_form.hidden_field :_destroy, class: "destroy-field" %>
              </div>
            <%end%>
        </div>
       <button type="button" data-repeater-create class="btn btn-outline-info btn-sm btn-add-g" >+ Add</button>
       
      </div>

      <div class="repeater_proj" >
        <h3>Projects</h3>
        <div data-repeater-list="curriculum_vitae[cv_projects_attributes]" >
          <%= form.fields_for :cv_projects do |project_form| %>
            <div class="row" data-repeater-item  style="margin-left: 0px;margin-top: 4px; margin-bottom: 2px;">
              <div class="col-3" style="padding-right: 0px;padding-left: 0px;">
                <%= project_form.select(:original_project_id, grouped_options_for_select(helper_grouped_projects_options , selected: project_form.object.original_project_id), {prompt: "Select a project"}, {class: "form-control" ,onchange: "project_select(this)"}) %>
              </div>
              <div class="col-7" id="cloned_content">
                <div class="form-group">
                  <%= project_form.label :title %>
                  <%= project_form.text_field :title ,class:"form-control" %>
                </div>
                <div class="form-group">
                  <%= project_form.label :desc %>
                  <%= project_form.text_area :desc ,class:"form-control"%>
                </div>
                <div class="form-group">
                  <%= project_form.label :role %>
                  <%= project_form.text_field :role ,class:"form-control"%>
                </div>
                <div class="form-group">
                  <%= project_form.label :responsibility %>
                  <!-- <%= project_form.text_field :responsibility ,class:"form-control"%> -->
                  <%#= project_form.text_field :responsibility, as: :ckeditor, input_html: { ckeditor: { toolbar: 'Full' } } %>
                  <%#=project_form.cktext_area :responsibility, class: 'someclass', ckeditor: {uiColor: '#AADC6E', language: 'uk'} %>
                  <%= project_form.text_area :responsibility, class: "ckeditor_g" %>
                </div>
                <div class="form-group">
                  <%= project_form.label :team_size %>
                  <%= project_form.number_field :team_size ,class:"form-control"%>
                </div>
                <div>
                  <div class="form-group">
                    <div class="row">
                      <div class="col-6">
                        <%= project_form.label :start_date %>
                        <%= project_form.date_field :start_date , max: Date.today ,class: 'form-control start_date container' ,onchange:"updateEndDate(this)"%>
                      </div>
                      <div class="col-6">
                        <%= project_form.label :end_date  %>
                        <%= project_form.date_field :end_date , max: Date.today ,class: 'form-control end_date container',onchange:"checkboxTogle(this)"%>
                      </div>
                    </div>
                  </div>
                  <div style="padding-left: 4%;" class="form-inline">
                    <input type="checkbox" id="inprogress_id" class="inprogress_checkbox" onchange="endDateDisable(this)">
                    <p style="margin-bottom: 0px;color: #657079;">currently running</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <%= project_form.label :core_skill %>
                      <!-- <%= project_form.fields_for :linkable_core_tech_attributes do |cs| %>
                        <%= cs.collection_select :tech_stack_id, TechStack.core_skills.order(:title), :id, :title, { include_blank: true } ,{class: "form-control" ,style:"height: 45px; margin-top: 7px;"} %>
                        <%end%> -->
                        <%= project_form.collection_select :proj_core_skill_id, TechStack.core_skills.order(:title), :id, :title, { include_blank: true } ,{class: "form-control" ,style:"height: 45px; margin-top: 7px;"} %>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <%= project_form.label :proj_supportive_skills  %>
                      <div>
                        <%= project_form.collection_select(:proj_supportive_skill_ids, TechStack.supportive_skills, :id, :title ,{}, { multiple: true ,class:"selectpick" ,onclick:"supportive_skills_fix()"}) %> 
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-2" style="padding: 0; height: 37px;display: inline-flex;">
                <button type="button"  class="g_sm_btn g btn btn-outline-danger  fa fa-close " , onclick="deleteRepeaterItem(this);" ></button>
                <button type="button" class="btn btn-outline-info fa fa-eye-slash g_sm_btn" , onclick="showHide(this);" ></button>
              </div>
              <%= project_form.hidden_field :_destroy, class: "destroy-field" %>
            </div>
          <%end%>
        </div>
        <div>
          <button type="button" data-repeater-create class="btn btn-outline-info btn-sm btn-add-g" , onclick="repeater_refresh()">+ Add</button>
        </div>
      </div>

      <div class="row">      
      <div class="col-md-6">
        <%= form.label "select profile image" %>
        <%= form.file_field :image %>
      </div>

      <div class="col-md-6">
        <%= form.label "Cv Layout"  %>
        <% template_files=Dir.glob(Rails.root.join('app', 'views' , 'HTML_templates' , '*.html.erb' )) %>
        <% @template_options=template_files.map { |file| File.basename(file, '.html.erb' )[1..] }%>
        <%= form.select(:template_name, @template_options , {}, {class: "form-control"}) %>
      </div>
      </div>

      <%= form.submit class: 'btn-primary' , style: "margin-top: 20px;" %>
 <% end%>
    